import{r as m,j as e,a as j}from"./app-Cf-DtJq5.js";import{D as w}from"./DashboardLayout-BqY-66oT.js";/* empty css            */const N=()=>{const[o,p]=m.useState({ref_no:"",cost_center_no:"",department:"",details_of_job:""}),[i,l]=m.useState([{id:Date.now(),item_code:"",description:"",quantity:1}]),[n,b]=m.useState({}),[u,h]=m.useState(!1),c=t=>{const{name:r,value:a}=t.target;p(s=>({...s,[r]:a})),n[r]&&b(s=>{const d={...s};return delete d[r],d})},x=(t,r,a)=>{l(s=>s.map(d=>d.id===t?{...d,[r]:a}:d))},f=()=>{l(t=>[...t,{id:Date.now(),item_code:"",description:"",quantity:1}])},g=t=>{i.length>1&&l(r=>r.filter(a=>a.id!==t))},y=t=>{t.preventDefault(),h(!0);const r=i.filter(s=>s.description.trim()!==""||s.item_code.trim()!=="").map(s=>({item_code:s.item_code,description:s.description,quantity:s.quantity})),a={...o,materials:r};j.post("/jobs",a,{onSuccess:()=>{alert("Job created successfully!"),p({ref_no:"",cost_center_no:"",department:"",details_of_job:""}),l([{id:Date.now(),item_code:"",description:"",quantity:1}])},onError:s=>{b(s),alert("Please fix the validation errors.")},onFinish:()=>{h(!1)}})};return e.jsxs("div",{className:"max-w-6xl mx-auto",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-6",children:"Add New Job"}),e.jsxs("form",{onSubmit:y,className:"bg-white shadow-md rounded-lg p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700 mb-4 border-b pb-2",children:"Basic Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),e.jsx("input",{type:"text",name:"ref_no",value:o.ref_no,onChange:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.ref_no?"border-red-500":"border-gray-300"}`,placeholder:"Enter reference number",required:!0}),n.ref_no&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.ref_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cost Center No."}),e.jsx("input",{type:"text",name:"cost_center_no",value:o.cost_center_no,onChange:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.cost_center_no?"border-red-500":"border-gray-300"}`,placeholder:"Enter cost center number",required:!0}),n.cost_center_no&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.cost_center_no})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),e.jsx("input",{type:"text",name:"department",value:o.department,onChange:c,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.department?"border-red-500":"border-gray-300"}`,placeholder:"Enter department",required:!0}),n.department&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.department})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Details of Job"}),e.jsx("textarea",{name:"details_of_job",value:o.details_of_job,onChange:c,rows:4,className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${n.details_of_job?"border-red-500":"border-gray-300"}`,placeholder:"Provide detailed description of the job",required:!0}),n.details_of_job&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:n.details_of_job})]})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4 border-b pb-2",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-700",children:"Materials"}),e.jsxs("button",{type:"button",onClick:f,className:"px-3 py-1 bg-green-500 text-white text-sm rounded-md hover:bg-green-600 transition-colors flex items-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Material"]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Item Code"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Description"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantity"}),e.jsx("th",{className:"px-4 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Action"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(t=>e.jsxs("tr",{children:[e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("input",{type:"text",value:t.item_code,onChange:r=>x(t.id,"item_code",r.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Item code"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("input",{type:"text",value:t.description,onChange:r=>x(t.id,"description",r.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Material description"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:e.jsx("input",{type:"number",min:"1",value:t.quantity,onChange:r=>x(t.id,"quantity",parseInt(r.target.value)||0),className:"w-full px-2 py-1 border border-gray-300 rounded-md focus:outline-none focus:ring-1 focus:ring-blue-500"})}),e.jsx("td",{className:"px-4 py-3 whitespace-nowrap",children:i.length>1&&e.jsx("button",{type:"button",onClick:()=>g(t.id),className:"text-red-500 hover:text-red-700",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})})]},t.id))})]})})]}),e.jsxs("div",{className:"flex justify-end space-x-4",children:[e.jsx("button",{type:"button",className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 transition-colors",onClick:()=>window.history.back(),disabled:u,children:"Cancel"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:blue-600 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",disabled:u,children:u?"Creating...":"Create Job"})]})]})]})};N.layout=o=>e.jsx(w,{children:o});export{N as default};
